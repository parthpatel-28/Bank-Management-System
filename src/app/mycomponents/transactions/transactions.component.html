<p-toast position="top-center" key="success" [baseZIndex]="50000"></p-toast>
<div class="col-12">
  <div class="title py-2">
     <h4>Transactions</h4>
  </div>
</div>

<div class="row">
  <div class="col-12 ">
      <div class="filters-container">      
          <p-dropdown  [options]="branches" [(ngModel)]="selectedBranch" optionLabel="location" placeholder="Select a Branch"
            [filter]="true">
          </p-dropdown>
          
          <p-dropdown  [options]="status" [(ngModel)]="statusName" optionLabel="name" placeholder="Select a Status"
          [filter]="true">
          </p-dropdown>


        <button class="btn btn-success btn-light-success waves-effect waves-light search-btn" (click)="Click_Search($event)">
          <i class="pi pi-search" style="font-size: 0.8rem;font-weight: 600;"></i>
        </button>

        <button class="btn btn-secondary waves-effect ml-1 reset-btn" (click)="Click_Reset()">
          <i class="pi pi-replay" style="font-size: 0.8rem;font-weight: 600;"></i>
        </button>
      </div>
  </div>
</div>




<div class="row mt-2 d-flex justify-content-around border-bottom">
  <!-- First Chart -->
  <div class="col-lg-4 col-md-8 col-sm-12 p-4">
    <div class="p-4 p-card">
      <h5 style="text-align: center; font-weight: 600;">Transaction Type</h5>
      <div class="p-card-body">
        <p-chart type="doughnut" [data]="regionData" [options]="{responsive: true, plugins: {legend: {position: 'bottom'}}}"></p-chart>
      </div>
    </div>
  </div>

  <div class="col-lg-2 col-md-4 col-sm-12  d-flex flex-wrap justify-content-center align-content-md-center gap-5  mt-2 ">  
    <div *ngFor="let card of regionData.labels , let i = index" class="col-12 p-card">
      <div class="p-card-body box-style">
       <p style=" text-align: center; font-weight: 700; color: rgb(69, 67, 67);">{{card}} : 
        <span style="font-weight: 700;color: #001845;">
           {{ regionData.datasets[0].data[i] }}</span> </p>
    </div>
   </div>
  </div>

  <!-- Second Chart -->
  <div class="col-lg-4 col-md-8 col-sm-12 p-4">
    <div class="p-4 p-card">
      <h5 style="text-align: center; font-weight: 600;">Transaction Mode</h5>
      <div class="p-card-body">
        <p-chart type="doughnut" [data]="transactionModeData" [options]="{responsive: true, plugins: {legend: {position: 'bottom'}}}"></p-chart>
      </div>
    </div>
  </div>

  <div class="col-lg-2 col-md-4 col-sm-12 d-flex flex-wrap justify-content-center align-content-md-center gap-5  mt-2 ">  
    <div *ngFor="let card of transactionModeData.labels ;let i = index" class="col-12 p-card">
      <div class="p-card-body box-style">
       <p style=" text-align: center; font-weight: 700; color: rgb(69, 67, 67);">
        {{card}} :<span style="font-weight: 700;color: #001845;">
           {{ transactionModeData.datasets[0].data[i] }}</span> </p>
    </div>
   </div>
  </div>
  
</div>



<div class="row mt-4 mb-1 ">
  <div class="col-12 d-flex justify-content-start gap-2">
    <button class="excel-btn" (click)='exportToExcel()'  style="border-bottom-left-radius: 0; border-bottom-right-radius: 0;"
    pTooltip="Convert to Excelsheet " tooltipPosition="top">  <i class="pi pi-file-excel"></i>
      <span>EXCEL</span>
    </button>
  </div>
</div>


<div class="col-12 mt-1">
  <div class="card">
    <p-table [value]="transactionData" [paginator]="true" [rows]="10" [responsiveLayout]="'scroll'">
      <ng-template pTemplate="header" styleClass="p-datatable-striped" class="p-table-striped">
        <tr>
          <th></th>
          <th>Transaction ID</th>
          <th>Status</th>
          <th>Transaction Date</th>
          <th>Amount</th>
          <th>Transaction Type</th>
          <th>Region</th>
          <th>Branch</th>
          <th>Transaction Mode</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData>
        <tr class="ml-5">
          <th>
            <button pTooltip="Copy Transaction ID" tooltipPosition="left" class="btn btn-primary " 
            (click)="copyToClipboard(rowData.transactionId)" style="margin-left: 20%;">
              <i class="pi pi-copy" style="font-size: 0.8rem"></i>
            </button>
          </th>
          <td>{{ rowData.transactionId }}</td>
          <td>
            <span 
              class="status-pill"
              [ngStyle]="getColor(rowData.transactionStatus)">
              {{ rowData.transactionStatus }}
            </span>
          </td>
          <td>{{ rowData.transactionDate }}</td>
          <td>â‚¹{{ rowData.transactionAmount | number }}</td>
          <td>{{ rowData.transactionType }}</td>
          <td>{{ rowData.region }}</td>
          <td>{{ rowData.branch }}</td>
          <td>{{ rowData.transactionMode }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
